# 소프트웨어 개발 보안 설계
## 소프트웨어 개발 보안 설계
#### SW 개발 보안의 3대 요소
- 기밀성 : 인가되지 않은 개인 혹은 시스템 접근에 따른 정보 공개 및 노출을 차단하는 특성
- 무결성 : 정당한 방법을 따르지 않고서는 데이터가 변경될 수 없음
- 가용성 : 권한을 가진 사용자가 어플리케이션이 원하는 서비스를 지속적으로 사용할 수 있도록 보장하는 특성

#### SW 개발 보안 용어
- 자산
- 위협
- 취약점
- 위험

## SW 개발 보안을 위한 공격기법의 이해
### DoS 공격
- 시스템을 악의적으로 공격해서 해당 시스템의 자원을 부족하게 하여 원래 의도된 용도로 사용하지 못하게 하는 공격

#### 종류
- SYN 플러딩 : __TCP 프로토콜의 구조적인 문제를 이용한 공격__. __SYN 패킷__ 만 보내 점유하여 다른 사용자가 서버를 사용하지 못하게 함
- UDP 플러딩 : __대량의 UDP 패킷__ 을 만들어 임의의 포트 번호로 전송, 응답 메세지를 생성하게 하여 지속해서 자원을 고갈시키는 공격
- 스머프/스머핑 : 출발지 주소를 공격 대상의 IP로 설정하여 네트워크 전체에게 ICMP Echo 패킷을 __직접 브로드캐스팅__ 하여 마비시키는 공격
- 죽음의 핑 : __ICMP 패킷을 정상적인 크기보다 아주 크게 만들어 전송__ 하여 __다수의 IP 단편화가 발생__ 하고 재조합 하는 과정에서 많은 부하 발생 또는 오버플로우 발생
- 랜드 어택 : __출발지 IP와 목적지 IP를 같은 패킷 주소__ 로 만들어 보냄으로써 시스템 가용성 침해
- 티어 드롭 : IP 패킷 재조합 과정에서 __잘못된 Fragment Offset 정보__ 로 인해 수신시스템에 문제가 발생하도록 함
- 봉크/보잉크 : __프로토콜의 오류 제어__ 를 이용한 공격기법 (봉크 -> 같은 시퀀스 번호, 보잉크 -> 일정 간격으로 시퀀스 번호에 빈 공간 생성)

### DDoS 공격
- __여러 대의 공격자를 분산 배치하여 동시에 동작__ 하게 함으로써 특정 사이트를 공격하는 기법
#### 공격 구성요소
- 핸들러
- 에이전트
- 마스터
- 공격자
- 데몬 프로그램

#### 공격 도구
- Trinoo : 많은 소스로부터 통합된 __UDP Flood 서비스 거부 공격을 유발__ 하는데 사용되는 도구
- Tribe Flood Network : __trinoo와 거의 유사함__. TCP SYN Flood, ICMP echo 요청 공격, ICMP 브로드캐스트 공격 수행 가능
- Stacheldraht 

### DRDoS 공격
- 출발지 IP를 공격대상 IP로 위조하여 다수의 __반사 서버로 요청 정보를 전송__ , 공격 대상자는 __반사 서버로부터 다량의 응답__ 을 받아서 서비스 거부가 되는 공격

### 애플리케이션 공격
- HTTP GET 플러딩 : __과도한 GET 메세지__ 를 이용하여 웹 서버의 과부하를 유발시키는 공격
- Slowloris : 헤더의 최종 끝을 알리는 개행 문자열인 __/r/n/r/n을 전송하지 않고 /r/n만 전송__ 하여 연결상태를 장시간 지속, 연결 자원을 모두 소진시키는 공격
- RUDY(Slow HTTP POST DoS) : 요청 헤더의 __Content-Lenght를 비정상적으로 크게 설정__ 하여 메세지 바디 부분을 매우 소량으로 보내 연결상태를 유지시키는 공격
- Slow HTTP Read DoS : TCP 윈도 크기와 __데이터 처리율을 감소시킨 상태에서 다수 HTTP 패킷을 지속적으로 전송__ 하여 연결상태가 장시간 지속되게 하는 공격
- Hulk DoS : __웹 페이지 주소(URL)를 지속적으로 변경__ 하면서 다량으로 GET 요청을 발생시키는 공격
- Hash DoS : 조작된 많은 수의 파라미터를 POST 방식으로 웹 서버에 전달하여 __다수의 해시 충돌을 발생__ 시켜 자원을 소모시키는 공격

### 네트워크 공격
- 스니핑 : __직접 공격은 하지 않고 데이터만 몰래 들여다보는__ 수동적 공격 기법
- 네트워크 스캐너, 스니퍼 : 네트워크 하드웨어 및 소프트웨어 구성의 취약점 파악을 위해 __공격자가 취약점을 탐색__ 하는 공격 도구
- 패스워드 크래킹
  - 사전 크래킹 : ID와 패스워드를 크랙하기 위해서 __가능성이 있는 단어를 파일로 만들어 놓고 대입__ 하여 크랙하는 공격기법
  - 무차별 크래킹 : __무작위로 패스워드 자리에 대입__ 하여 알아내는 공격기법
  - 패스워드 하이브리드 공격 : 사전 공격과 무차별 대입 공격을 결합 
  - 레인보우 테이블 공격 : 패스워드 별로 해시 값을 미리 생성해서 테이블에 모아 놓고, __크래킹 하고자 하는 해시 값을 테이블에서 검색해서 역으로 패스워드를 찾는 기법__ 
- IP 스푸핑 : __인증된 컴퓨팅 시스템인것처럼 속여서 본인의 패킷 헤더를 인증된 호스트의 IP 주소로 위조__ 하여 타깃에 전송하는 공격 기법
- ARP 스푸핑 : __특정 호스트의 MAC 주소를 자신의 MAC 주소로 위조한 ARP Reply를 만들어 희생자에게 지속적으로 전송__
- ICMP Redirect 공격 : 스니핑 시스템을 네트워크에 존재하는 __또다른 라우터라고 알림__ 으로써 __패킷의 흐름을 바꾸는 공격기법__ 
- 트로이 목마 : 겉보기에는 정상적인 프로그램으로 보이지만 실행하면 악성 코드를 실행하는 프로그램

### 시스템 보안 위협
#### 버퍼 오버플로우 공격
- 메모리에 __할당된 버퍼 크기를 초과하는 양의 데이터를 입력__ 하여 프로세스 흐름을 변경시켜 악성 코드를 실행시키는 방법

#### 유형
- 스택 버퍼 오버플로우 공격 : 스택 영역에 버퍼 크기를 초과하는 양의 데이터를 입력하여 __복귀 주소를 변경__ 하고 공격자가 원하는 임의의 코드를 실행하는 기법
- 힙 버퍼 오버플로우 공격 : 힙 영역에 버퍼 크기를 초과하는 양의 데이터를 입력하여 __메모리의 데이터와 함수 주소 등을 변경__ 하여 공격자가 원하는 임의의 코드를 실행하는 기법

#### 대응방안
- 스택가드 : __카나리__ 라고 불리는 무결성 체크용 값을 복귀 주소와 변수 사이에 삽입해 두고, 버퍼 오버플로우 발생 시 카나리 값 체크
- 스택쉴드 : 함수 시작 시 복귀 주소를 __Global RET__ 일아는 특수 스택에 저장해 두고 __함수 종료 시 저장된 값과 스택의 Global RET 값을 비교__ 해서 다를 경우 오버플로우로 간주
- ASLR : __주소 공간 배치를 난수화하고 실행 시마다 메모리 주소를 변경__ 시켜 버퍼 오버플로우를 통한 특정 주소 호출 차단
- 안전한 함수 활용
- 실행 제한

#### 백도어
- 어떤 제품이나 컴퓨터 시스템, 암호시스템 혹은 알고리즘에서 __정상적인 인증 절차를 우회하는 기법__

#### 백도어 탐지 기법
- 프로세스 및 열린 포트 확인 : TCPView, 리눅스에서는 ps -ef, Netstat -an
- Setuid 파일 검사
- 백신 및 백도어 탐지 툴 활용
- 무결성 검사 : Tripwire -> No such file or directory (정상)
- 로그 분석

#### 주요 시스템 보안 공격기법
- 포맷 스트링 공격 : 외부로부터 __입력된 값을 검증하지 않고__ 입출력 함수의 포맷 스트링을 그대로 사용하는 경우 발생하는 취약점 공격기법
- 레이스 컨디션 공격 : 둘 이상의 프로세스나 스레드가 __공유자원을 동시에 접근할 때 접근 순서에 따라 비정상적인 결과가 발생__ 하는 조건/상황
- 키로거 공격 : 컴퓨터 사용자의 키보드 움직임을 탐지해서 저장하고, 개인의 중요한 정보를 몰래 빼가는 해킹 공격
- 루트킷 : 시스템 침입 후 침입 사실을 숨긴 채 백도어, 트로이 목마 등 불법적인 해킹에 사용되는 기능을 제공하는 프로그램 모음

### 보안 관련 용어
- 스피어피싱 : 사회 공학의 한 기법, 일반적인 이메일로 위장한 메일을 지속적으로 발송하여, 링크나 첨부파일을 클릭하도록 유도하여 개인정보를 탈취하는 공격기법
- 스미싱 : SMS과 Phising의 합성어
- 큐싱 : QR코드와 Phising의 합성어
- 봇넷 : 악성 프로그램이 감염되어 악의적인 용도로 사용될 수 있는 다수의 컴퓨터들이 네트워크로 연결된 형태
- APT 공격 : 특정 타깃을 목표로 하여 다양한 수단을 통한 지속적으로 지능적인 맞춤형 공격기법
- 공급망 공격 : 소프트웨어 개발사의 네트워크에 침투 -> 설치나 업데이트 시 자동적으로 감염되도록 하는 공격기법
- 제로데이 공격 : 보안 취약점이 발견되어 널리 공표되기 전에 해당 취약점을 악용하여 공격하는 기법
- 웜 : 스스로 복제하여 네트워크 등의 연결을 통하여 전파하는 악성 소프트웨어 프로그램. 독자적으로 실행되며 다른 프로그램이 필요하지 않음
- 악성 봇 : 스스로 실행되지 못하고, 해커의 명령에 의해 원격에서 제어 또는 실행이 가능한 프로그램 혹은 코드
- 사이버 킬체인 : 록히드 마틴의 공격형 방위시스템,  APT 공격 방어 분석 모델
- 랜섬웨엉 : 감염된 시스템의 파일들을 암호화하여 복호화 할 수 없도록 하고, 돈을 요구하는 악성 소프트웨어
- 이블 트윈 공격: __무선 Wifi 피싱 기법, 합법적인 Wifi 제공자처럼 행세__ 하며 노트북이나 휴대 전화로 연결한 무선 사용자들의 정보를 탈취하는 공격기법
- 난독화 : 코드의 가독성을 낮춰 역공학에 대비하기 위해서 프로그램 코드의 일부 또는 전체를 변경하는 기법
- Tripwire : 크래커가 침입하여 시스템에 백도어를 만들어 놓거나 설정 파일을 변경해 놓았을 때 이러한 사실을 알 수 있게 분석하는 도구
- Ping : 원격 호스트가 정상적으로 운영되고 있는지 확인하는 목적
- Tcpdump : 패킷의 내용을 출력해주는 프로그램

## 서버 인증 및 접근 통제
### 개념
- 다중 사용자 시스템과 망 운영 시스템에서 접속자의 로그인 정보를 확인하는 보안 절차

### 기능
- 스니핑 방지
- 피싱 방지
- 데이터 변조 방지
- 기업 신뢰도 향상

### 인증 기술의 유형
- 지식기반 인증 : 사용자가 기억하고 있는 지식
- 소지기반 인증 : 소지하고 있는 사용자 물품
- 생체기반 인증 : 고유한 사용자 생체 정보
- 특징기반 인증 : 사용자 특징 활용

### 서버 접근 통제
- 사람 또는 프로세스가 서버 내 파일에 읽기, 쓰기, 실행 등 접근 여부를 허가하거나 거부하는 기능

#### 접근 통제 기법
- 식별
- 인증
- 인가
- 책임추적성

### 서버 접근 통제의 유형
- 임의적 접근 통제 (DAC) : 사용자/그룹의 신분 기반으로 제한
- 강제적 접근 통제 (MAC) : 허용등급을 기준으로 접근을 제한
- 역할기반 접근 통제 (RBAC) : 중앙 관리자가 통제, 맡은 역할에 기초하여 접근을 제한

### 접근 통제 보호 모델
- 벨-라파듈라 모델 : No Read Up, No Write Down. 미 국방부 지원 보안 모델, __기밀성 강조__
- 비바 모델 : No Read Down, No Write Up 벨-라파둘라 모델 단점 보완, __무결성 보장__

## 암호 알고리즘
### 양방향 방식
#### 대칭 키 암호 방식
- 암호화와 복호화에 같은 암호 키를 쓰는 알고리즘
- 블록 암호 방식 : 고정 길이의 블록을 암호화
  - DES : 1975년 미국의 연방 표준국, 블록 크기 64bit, 키 길이 56bit
  - AES : 1999년 한국인터넷진흥원, 블록 크기 128bit
  - SEED : 미국 표준 기술연구소, 라운드 수 10, 12, 14
  - ARIA : 국가정보원과 산학연구협회
  - IDEA
  - LFSR
- 스트림 암호 방식 : 매우 긴 주기의 난수열을 발생
  - RC4
#### 비대칭 키 암호 방식
- 공개키로 암호화된 메세지는 반드시 비밀키로 복호화
- 공개키는 누구나 알 수 있지만 비밀키는 키 소유자만 알 수 있어야 함
- RSA : 3명의 MIT 교수, 큰 인수의 곱을 소인수분해
- ECC : 타원 곡선 암호
- Elgamal : 이산대수의 계산
- 디피-헬만 : 최초의 공개키 알고리즘, 이산대수 계산

### 일방향 암호 방식 (해시)
- 임의 길이의 정보를 입력받아 고정된 길이의 암호문을 출력하는 암호 방식
- __복호화 불가능__
- MAC : 메시지 인증 코드, 메시지의 무결성과 송신자 인증 보장
- MDC : 키를 사용하지 않는 변경 감지 코드
- MD5 : MD4 개선
- SHA-1 : NSA에서 미 표준으로 지정, 160비트
- SHA-256/384/512 : 128, 192, 256비트
- HAS-160 : 국내 표준 서명 알고리즘

## 안전한 전송을 위한 데이터 암호화 전송
### IPSec
- __IP(3계층)__ 에서 무결성과 인증을 보장하는 __인증 헤더(AH)__ 와 기밀성을 보장하는 __암호화(ESP)__ 를 이용한 __IP 보안 프로토콜__

#### IPSec 프로토콜
- 인증(AH) 프로토콜 : 기밀성(암호화) 제공 안함
- 암호화(ESP) 프로토콜 : 암호화 이용
- 키 관리(IKE) 프로토콜 : key를 주고받는 알고리즘

### SSL/TLS
- 전송계층(4계층)과 응용계층(7계층) 사이에서 클라이언트와 서버 간의 웹 데이터 암호화(기밀성), 상호 인증 및 전송시 데이터 무결성을 보장

#### 구성요소
- Change Cipher Spec Protocol : 협상이 끝난 Cipher Spec을 상대에게 알림
- Alert Protocol : SSL/TLS 관련 경고 메세지 전달
- Heartbeat Protocol : 서버와 클라이언트가 정상적인 상태인지 확인
- Handshake Protocol : 서버와 클라이언트가 서로 인증하고 암호화 키를 협상하는 프로토콜
- Record Protocol : 합의된 Cipher Suite로 암,복호화, 무결성, 압축, 해제 등 수행

### S-HTTP 
- 웹상에서 네트워크 트래픽을 암호화하는 주요 방법 중 하나로 클라이언트와 서버 간에 전송되는 모든 메세지를 각각 암호화하여 전송하는 기술

# 소프트웨어 개발 보안 구현
## SW 개발 보안 구현
### 시큐어 코딩 가이드
- 잠재적인 보안 취약점을 사전에 제거, 안전한 소프트웨어를 개발하는 기법

### 입력 데이터 검증 및 표현
#### 입력 데이터 검증 및 표현 취약점
- XSS : 웹페이지에 포함된 부적절한 스크립트가 실행되는 공격
- 사이트 간 요청 위조 (CSRF) : 사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위를 특정 웹사이트에 요청하게 하는 공격
- SQL 삽입 : 악의적인 SQL 구문을 삽입, 실행시켜서 DB의 접근을 통해 정보를 탈취하거나 조작하는 행위를 하는 공격

### 코드 오류
- 구현 단계에서 프로그램 변환 시 오류

#### 코드 오류 취약점
- 널 포인터 역참조 : 일반적으로 그 객체가 Null이 될 수 없다고 하는 가정을 위반했을 때 발생
- 정수를 문자로 변환 : 정수를 문자로 변환하면서 표현할 수 없는 범위의 값이 잘려나가 문자에 대한 저장 값이 올바르지 않은 보안 취약점
- 부적절한 자원 해제
- 초기화되지 않은 변수 사용

## 시스템 보안 구현
### 유닉스/리눅스 주요 로그 파일
- wtmp(x) : 사용자 로그인/로그아웃 정보 (last 명령어)
- btmp(x) : 로그인에 실패한 정보

### 보안 솔루션
#### 네트워크 보안 솔루션
- 네트워크 접근 제어 (NAC) : 내부 네트워크에 접속을 시도할 때 이를 제어
- 침입 탐지 시스템 (IDS) : 침입을 실시간으로 탐지
- 침입 방지 시스템 (IPS) : 침입을 실시간으로 차단, 조치를 능동적으로 처리
- 가상사설망 (VPN) : 공중망에 인증, 암호화, 터널링 기술을 활용하여 __마치 전용망을 사용하는 효과__

## 비즈니스 연속성 계획(BCP) 
- 각종 재해, 장애, 재난으로부터 위기관리를 기반으로 비즈니스 연속성을 보장하는 체계

### 주요 용어
- BIA : 주요 손실을 볼 것을 가정하여 시간 흐름에 따른 영향도 및 손실평가를 조사하는 비즈니스 영향 분석
- RTO : 업무중단 시점부터 업무가 복구되어 다시 가동될 때까지의 시간. 재해 시 복구 목표 시간의 선정
- RPO : 재해 시 복구 목표 지점의 선정
- DRP : 장기간에 걸쳐 시설의 운영이 불가능한 경우 재난 복구 계획
- DRS : 관리체계가 통합된 재해복구센터
  - Mirror Site : 주 센터와 복구센터 모두 운영 상태로 실시간 동시 서비스가 가능
  - Hot Site : 재해 발생 시 복구까지(RTO) 4시간 이내
  - Warm Site : 재해 발생 시 복구까지(RTO) 수일 ~ 수주
  - Cold Site : 재해 발생 시 복구까지(RTO) 수주 ~ 수개월

## 보안 중요 용어
- 부 채널 공격 : 물리적 특성을 측정
- 드라이브 바이 다운로드 : 불특정 웹 서버와 페이지에 악성 스크립트 설치, 불특정 사용자 접속 시 동의 없이 실행되어 감염
- 워터링홀 : 특정인에 대한 표적 공격이 목적, 자주 방문하는 사이트에 악성코드를 심는 등
- 하트 블리드 : 하트비트
- 토르 네트워크 : 네트워크 경로를 알 수 없도록 암호화 기법 사용
- 스턱스넷 공격 : 독일 지멘스사의 SCADA 시스템을 공격 목표로 제작
- 핑거프린팅 : 저작권 정보와 구매한 사용자 정보를 삽입








